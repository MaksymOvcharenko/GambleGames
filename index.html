<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–Ü–≥—Ä–æ–≤—ñ –ê–≤—Ç–æ–º–∞—Ç–∏ 3x3</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #f4f4f4;
        margin: 0;
        font-family: Arial, sans-serif;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        grid-template-rows: repeat(3, 100px);
        gap: 5px;
        margin-top: 20px;
      }
      .cell {
        width: 100px;
        height: 100px;
        background-color: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 48px;
        cursor: pointer;
        border: 1px solid #ccc;
        transition: transform 0.3s;
      }
      .start-button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        margin-top: 10px;
      }
      .start-button:hover {
        background-color: #0056b3;
      }
      .result,
      .balance {
        margin-top: 20px;
        font-size: 24px;
        font-weight: bold;
      }
      .stake {
        margin-top: 10px;
        font-size: 18px;
      }
      .stake input {
        width: 60px;
        text-align: center;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div class="stake">
      –°—Ç–∞–≤–∫–∞:
      <input type="number" id="stakeInput" value="10" min="2" step="1" />
    </div>
    <button class="start-button" id="startButton">–°—Ç–∞—Ä—Ç</button>
    <div class="grid" id="grid">
      <!-- –Ø—á–µ–π–∫–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ —Ç—É—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é JavaScript -->
    </div>
    <div class="balance" id="balance">–ë–∞–ª–∞–Ω—Å: 1000 –∑–ª–æ—Ç–∏—Ö</div>
    <div class="result" id="result"></div>
    <script>
      const items = [
        "üçé",
        "üçê",
        "üçä",
        "üçã",
        "üçå",
        "üçâ",
        "üçá",
        "üçì",
        "ü´ê",
        // "üçí",
        // "üçë",
        // "ü•≠",
        // "üçç",
        // "ü••",
        // "ü•ù",
      ];
      const grid = document.getElementById("grid");
      const startButton = document.getElementById("startButton");
      const result = document.getElementById("result");
      const balanceDisplay = document.getElementById("balance");
      const stakeInput = document.getElementById("stakeInput");
      let cells = [];
      let balance = 1000;

      function updateBalanceDisplay() {
        balanceDisplay.textContent = `–ë–∞–ª–∞–Ω—Å: ${balance} –∑–ª–æ—Ç–∏—Ö`;
      }

      function initializeGrid() {
        grid.innerHTML = "";
        cells = [];
        for (let i = 0; i < 9; i++) {
          const cell = document.createElement("div");
          cell.className = "cell";
          grid.appendChild(cell);
          cells.push(cell);
        }
      }

      function startGame() {
        const stake = parseInt(stakeInput.value, 10);
        if (balance < stake) {
          alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–æ—à—Ç—ñ–≤ –¥–ª—è –≥—Ä–∏.");
          return;
        }

        balance -= stake;
        updateBalanceDisplay();
        result.textContent = "";

        cells.forEach((cell, index) => {
          setTimeout(() => {
            const randomItem = items[Math.floor(Math.random() * items.length)];
            cell.textContent = randomItem;
            cell.style.transform = "rotateY(360deg)";
            setTimeout(() => {
              cell.style.transform = "rotateY(0)";
            }, 300);
          }, index * 100);
        });

        setTimeout(() => checkForMatches(stake), 1200);
      }

      function checkForMatches(stake) {
        const checkMatch = (arr) =>
          arr.every(
            (cell) =>
              cell.textContent === arr[0].textContent && cell.textContent !== ""
          );

        let totalWin = 0;

        // Check horizontal matches
        for (let row = 0; row < 3; row++) {
          const line = cells.slice(row * 3, row * 3 + 3);
          if (checkMatch(line)) {
            totalWin += (items.indexOf(line[0].textContent) + 1) * stake;
          }
        }

        // Check vertical matches
        for (let col = 0; col < 3; col++) {
          const line = [cells[col], cells[col + 3], cells[col + 6]];
          if (checkMatch(line)) {
            totalWin += (items.indexOf(line[0].textContent) + 1) * stake;
          }
        }

        // Check diagonal matches (left-to-right)
        const diag1 = [cells[0], cells[4], cells[8]];
        if (checkMatch(diag1)) {
          totalWin += (items.indexOf(diag1[0].textContent) + 1) * stake;
        }

        // Check diagonal matches (right-to-left)
        const diag2 = [cells[2], cells[4], cells[6]];
        if (checkMatch(diag2)) {
          totalWin += (items.indexOf(diag2[0].textContent) + 1) * stake;
        }

        balance += totalWin;
        updateBalanceDisplay();

        if (totalWin > 0) {
          result.textContent = `–í–∏ –≤–∏–≥—Ä–∞–ª–∏: ${totalWin} –∑–ª–æ—Ç–∏—Ö!`;
        } else {
          result.textContent = "–ù–∞ –∂–∞–ª—å, –≤–∏–≥—Ä–∞—à—ñ–≤ –Ω–µ–º–∞—î.";
        }
      }

      startButton.addEventListener("click", startGame);
      initializeGrid();
      updateBalanceDisplay();
    </script>
  </body>
</html>
